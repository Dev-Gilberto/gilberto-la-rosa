---
import Layout from "../../layouts/Layout.astro";
import Posts from "../../components/Posts.astro";
import ButtonBack from "../../components/ButtonBack.astro";

import { slugify, formatBlogPosts } from "../../assets/js/utils";

export async function getStaticPaths() {
  return [
    {
      params: { tags: slugify("web developer") },
      props: { name: "web developer" },
    },
    {
      params: { tags: slugify("control de versiones") },
      props: { name: "control de versiones" },
    },
  ];
}

const { tags } = Astro.params;
const { name } = Astro.props;

const allPosts = await Astro.glob("../blog/*.md");
const formattedPosts = formatBlogPosts(allPosts);
const catPosts = formattedPosts.filter(
  (post) => slugify(post.frontmatter.tags) === tags
);
---

<Layout title={name}>
  <section class="w-[90%] mx-auto my-8" aria-label={`Posts about ${name}`}>
    <h1 class="text-6xl md:text-9xl font-bold capitalize">
      art√≠culos relacionados:
    </h1>
    <section class="text-center mb-8">
      <span
        class="text-2xl md:text-5xl uppercase font-medium py-4 px-8 rounded-xl border-b-8 border-[#f79533] tracking-wider"
        >{name}</span
      >
    </section>
    <section class="my-8">
      <ul class="flex flex-wrap gap-[10px]">
        {
          catPosts.map((post) => (
            <Posts frontmatter={post.frontmatter} url={post.url} />
          ))
        }
      </ul>
    </section>
    <section class="flex justify-center">
      <ButtonBack />
    </section>
  </section>
</Layout>
